---
import Layout from "../layouts/layout.astro";
import { DynamicForm } from "../components/dynamic-form";
import { rushConfig } from "../../rush.config";
import { rush } from "@/lib/rush";

const formId = rushConfig.locales!.pt_BR!.forms.contact;
let formSchema = null;
let error = null;

try {
    const response = await rush.request<any>(`/forms/${formId}`);
    formSchema = response.data;
} catch (e) {
    console.error('Failed to fetch contact form:', e);
    error = e;
}
---

<Layout title="Fale Conosco">
    <section class="py-20 md:py-32 bg-gray-50">
        <div class="max-w-2xl mx-auto px-4">
            <div class="text-center mb-12">
                <span class="text-[#009640] font-semibold tracking-wide uppercase text-sm mb-2 block">
                    Fale Conosco
                </span>
                <h1 class="text-3xl md:text-4xl font-bold text-[#009640] mb-4">
                    Entre em Contato
                </h1>
                <p class="text-gray-600 text-lg">
                    Estamos prontos para atender você. Preencha o formulário abaixo ou utilize nossos canais de atendimento.
                </p>
            </div>

            <div class="bg-white p-8 rounded-2xl shadow-sm border border-gray-100">
                {formSchema ? (
                    <DynamicForm client:visible form={formSchema} />
                ) : (
                   <div class="text-center py-8 text-red-600 bg-red-50 rounded-lg">
                        <p>Não foi possível carregar o formulário de contato.</p>
                        <p class="text-sm mt-2 opacity-75">Tente novamente mais tarde.</p>
                   </div>
                )}
            </div>
        </div>
    </section>
</Layout>

---
import { Image } from 'astro:assets'
import tab1 from '@/assets/images/tab-01.webp'
import tab2 from '@/assets/images/tab-02.webp'
import tab3 from '@/assets/images/tab-03.webp'

const tabs = [
    {
        id: 'intelecto',
        label: 'INTELECTO',
        title: 'Desenvolvimento Intelectual',
        content: [
            'Nossa metodologia foca no desenvolvimento cognitivo através de desafios estimulantes e aprendizado ativo.',
            'Utilizamos material didático atualizado e tecnologias educacionais que despertam a curiosidade e o pensamento crítico.',
            'O aluno é protagonista do seu aprendizado, construindo conhecimento de forma significativa.'
        ],
        image: tab1
    },
    {
        id: 'psicologico',
        label: 'PSICOLÓGICO',
        title: 'Apoio Psicológico',
        content: [
            'Valorizamos a saúde mental e o bem-estar emocional de nossos alunos.',
            'Contamos com suporte psicopedagógico para auxiliar no desenvolvimento das competências socioemocionais.',
            'Ambiente acolhedor que promove a autoestima, a empatia e o respeito às diferenças.'
        ],
        image: tab2
    },
    {
        id: 'fisico',
        label: 'FÍSICO',
        title: 'Desenvolvimento Físico',
        content: [
            'Incentivamos a prática de atividades físicas como parte fundamental da formação.',
            'Ampla área verde e quadras poliesportivas para recreação e esportes.',
            'Aulas de educação física que trabalham a coordenação motora, o trabalho em equipe e hábitos saudáveis.'
        ],
        image: tab3
    }
]
---

<section class="w-full py-16 lg:py-24 bg-gray-50 methodology-section">
    <div class="container mx-auto px-4">
        <div class="flex justify-center gap-3 mb-12" role="tablist">
            {tabs.map((tab, index) => (
                <button
                    type="button"
                    role="tab"
                    aria-selected={index === 0 ? 'true' : 'false'}
                    aria-controls={`panel-${index}`}
                    id={`tab-${index}`}
                    data-index={index}
                    class={`tab-btn px-6 py-3 text-sm font-bold uppercase tracking-wider transition-all rounded-lg ${
                        index === 0 ? 'text-white bg-[#009640]' : 'text-gray-600 bg-white hover:bg-gray-100 border-2 border-gray-200'
                    }`}
                >
                    {tab.label}
                </button>
            ))}
        </div>

        <div class="max-w-7xl mx-auto">
            {tabs.map((tab, index) => (
                <div
                    id={`panel-${index}`}
                    role="tabpanel"
                    aria-labelledby={`tab-${index}`}
                    class={`tab-panel ${index === 0 ? '' : 'hidden'}`}
                >
                    <div class="bg-[#009640] rounded-2xl shadow-xl overflow-hidden">
                        <div class="grid grid-cols-1 lg:grid-cols-5 gap-0">
                            <div class="lg:col-span-3 p-8 lg:p-12 xl:p-16 text-white">
                                <h3 class="text-3xl lg:text-4xl xl:text-5xl font-bold mb-6 leading-tight">
                                    {tab.title}
                                </h3>
                                <div class="text-base lg:text-lg leading-relaxed space-y-4">
                                    {tab.content.map((paragraph) => (
                                        <p class="text-white/90">{paragraph}</p>
                                    ))}
                                </div>
                            </div>

                            <div class="lg:col-span-2 relative min-h-[300px] lg:min-h-full">
                                <Image
                                    src={tab.image}
                                    alt={tab.title}
                                    class="tab-image w-full h-full object-cover"
                                />
                            </div>
                        </div>
                    </div>
                </div>
            ))}
        </div>
    </div>
</section>

<script>
    const section = document.querySelector('.methodology-section')
    if (section) {
        const btns = section.querySelectorAll('.tab-btn')
        const panels = section.querySelectorAll('.tab-panel')

        btns.forEach(btn => {
            btn.addEventListener('click', () => {
                const index = parseInt(btn.getAttribute('data-index') || '0')

                btns.forEach(b => {
                    b.setAttribute('aria-selected', 'false')
                    b.classList.remove('text-white', 'bg-[#009640]')
                    b.classList.add('text-gray-600', 'bg-white', 'hover:bg-gray-100', 'border-2', 'border-gray-200')
                })

                btn.setAttribute('aria-selected', 'true')
                btn.classList.add('text-white', 'bg-[#009640]')
                btn.classList.remove('text-gray-600', 'bg-white', 'hover:bg-gray-100', 'border-2', 'border-gray-200')

                panels.forEach((p, i) => {
                    if (i === index) {
                        p.classList.remove('hidden')
                        const img = p.querySelector('.tab-image')
                        if (img) {
                            img.classList.add('animate-in', 'fade-in', 'duration-500')
                            setTimeout(() => {
                                img.classList.remove('animate-in', 'fade-in', 'duration-500')
                            }, 500)
                        }
                    } else {
                        p.classList.add('hidden')
                    }
                })
            })
        })
    }
</script>

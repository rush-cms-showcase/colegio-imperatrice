---
import { Image } from 'astro:assets';
import tab1 from '@/assets/images/tab-01.webp';
import tab2 from '@/assets/images/tab-02.webp';
import tab3 from '@/assets/images/tab-03.webp';

const tabs = [
    {
        id: 'intelecto',
        label: 'INTELECTO',
        title: 'Desenvolvimento Intelectual',
        content: [
            'Nossa metodologia foca no desenvolvimento cognitivo através de desafios estimulantes e aprendizado ativo.',
            'Utilizamos material didático atualizado e tecnologias educacionais que despertam a curiosidade e o pensamento crítico.',
            'O aluno é protagonista do seu aprendizado, construindo conhecimento de forma significativa.'
        ],
        image: tab1
    },
    {
        id: 'psicologico',
        label: 'PSICOLÓGICO',
        title: 'Apoio Psicológico',
        content: [
            'Valorizamos a saúde mental e o bem-estar emocional de nossos alunos.',
            'Contamos com suporte psicopedagógico para auxiliar no desenvolvimento das competências socioemocionais.',
            'Ambiente acolhedor que promove a autoestima, a empatia e o respeito às diferenças.'
        ],
        image: tab2
    },
    {
        id: 'fisico',
        label: 'FÍSICO',
        title: 'Desenvolvimento Físico',
        content: [
            'Incentivamos a prática de atividades físicas como parte fundamental da formação.',
            'Ampla área verde e quadras poliesportivas para recreação e esportes.',
            'Aulas de educação física que trabalham a coordenação motora, o trabalho em equipe e hábitos saudáveis.'
        ],
        image: tab3
    }
];
---

<section class="w-full bg-[#009640] text-white relative methodology-section">
    <div class="relative grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
        <div class="p-8 lg:p-16 xl:p-32">
            <div class="flex max-lg:flex-col lg:flex-wrap gap-2 mb-12" role="tablist">
                {tabs.map((tab, index) => (
                    <button
                        type="button"
                        role="tab"
                        aria-selected={index === 0 ? 'true' : 'false'}
                        aria-controls={`panel-${index}`}
                        id={`tab-${index}`}
                        data-index={index}
                        class={`tab-btn px-6 py-3 text-sm font-bold uppercase tracking-wider transition-all relative top-[1px] rounded-lg ${
                            index === 0 ? 'text-[#009640] bg-white' : 'text-white/70 hover:text-white hover:bg-white/10'
                        }`}
                    >
                        {tab.label}
                    </button>
                ))}
            </div>

            <div class="max-lg:text-center min-h-[300px]">
                 {tabs.map((tab, index) => (
                    <div 
                        id={`panel-${index}`}
                        role="tabpanel"
                        aria-labelledby={`tab-${index}`}
                        class={`tab-panel animate-in fade-in slide-in-from-right-4 duration-500 ${index === 0 ? '' : 'hidden'}`}
                    >
                        <h3 class="text-3xl lg:text-6xl font-bold mb-8 text-slate-900 leading-tight">
                            {tab.title}
                        </h3>
                        <div class="text-lg leading-relaxed space-y-4 text-slate-900">
                            {tab.content.map((paragraph) => (
                                <p>{paragraph}</p>
                            ))}
                        </div>
                    </div>
                 ))}
            </div>
        </div>
        
        <div class="absolute top-0 right-0 h-full w-1/2 max-lg:hidden overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-full bg-gradient-to-r from-[#009640] to-transparent z-10 w-20"></div>
             {tabs.map((tab, index) => (
                <Image
                    src={tab.image}
                    alt={tab.title}
                    class={`tab-image w-full h-full object-cover transition-opacity duration-500 absolute inset-0 ${index === 0 ? 'opacity-100 z-10' : 'opacity-0 z-0'}`}
                />
            ))}
        </div>
    </div>
</section>

<script>
    const section = document.querySelector('.methodology-section');
    if (section) {
        const btns = section.querySelectorAll('.tab-btn');
        const panels = section.querySelectorAll('.tab-panel');
        const images = section.querySelectorAll('.tab-image');

        btns.forEach(btn => {
            btn.addEventListener('click', () => {
                const index = parseInt(btn.getAttribute('data-index') || '0');

                // Update Keys
                btns.forEach(b => {
                    b.setAttribute('aria-selected', 'false');
                    b.classList.remove('text-[#009640]', 'bg-white');
                    b.classList.add('text-white/70', 'hover:text-white', 'hover:bg-white/10');
                });
                
                btn.setAttribute('aria-selected', 'true');
                btn.classList.add('text-[#009640]', 'bg-white');
                btn.classList.remove('text-white/70', 'hover:text-white', 'hover:bg-white/10');

                // Update Panels
                panels.forEach((p, i) => {
                    if (i === index) p.classList.remove('hidden');
                    else p.classList.add('hidden');
                });

                // Update Images
                images.forEach((img, i) => {
                    if (i === index) {
                        img.classList.remove('opacity-0', 'z-0');
                        img.classList.add('opacity-100', 'z-10');
                    } else {
                        img.classList.remove('opacity-100', 'z-10');
                        img.classList.add('opacity-0', 'z-0');
                    }
                });
            });
        });
    }
</script>

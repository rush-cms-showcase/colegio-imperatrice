---
import { Image } from 'astro:assets'
import tab1 from '@/assets/images/tab-01.webp'
import tab2 from '@/assets/images/tab-02.webp'
import tab3 from '@/assets/images/tab-03.webp'
import Brain from '~icons/lucide/brain'
import Heart from '~icons/lucide/heart'
import Dumbbell from '~icons/lucide/dumbbell'
import Lightbulb from '~icons/lucide/lightbulb'
import BookOpen from '~icons/lucide/book-open'
import Target from '~icons/lucide/target'
import HandHeart from '~icons/lucide/hand-heart'
import Users from '~icons/lucide/users'
import Smile from '~icons/lucide/smile'
import TreePine from '~icons/lucide/tree-pine'
import Trophy from '~icons/lucide/trophy'
import HeartPulse from '~icons/lucide/heart-pulse'

const tabs = [
    {
        id: 'intelecto',
        label: 'INTELECTO',
        title: 'Desenvolvimento Intelectual',
        content: [
            { text: 'Nossa metodologia foca no desenvolvimento cognitivo através de desafios estimulantes e aprendizado ativo.', icon: 'lightbulb' },
            { text: 'Utilizamos material didático atualizado e tecnologias educacionais que despertam a curiosidade e o pensamento crítico.', icon: 'book' },
            { text: 'O aluno é protagonista do seu aprendizado, construindo conhecimento de forma significativa.', icon: 'target' }
        ],
        image: tab1
    },
    {
        id: 'psicologico',
        label: 'PSICOLÓGICO',
        title: 'Apoio Psicológico',
        content: [
            { text: 'Valorizamos a saúde mental e o bem-estar emocional de nossos alunos.', icon: 'handheart' },
            { text: 'Contamos com suporte psicopedagógico para auxiliar no desenvolvimento das competências socioemocionais.', icon: 'users' },
            { text: 'Ambiente acolhedor que promove a autoestima, a empatia e o respeito às diferenças.', icon: 'smile' }
        ],
        image: tab2
    },
    {
        id: 'fisico',
        label: 'FÍSICO',
        title: 'Desenvolvimento Físico',
        content: [
            { text: 'Incentivamos a prática de atividades físicas como parte fundamental da formação.', icon: 'treepine' },
            { text: 'Ampla área verde e quadras poliesportivas para recreação e esportes.', icon: 'trophy' },
            { text: 'Aulas de educação física que trabalham a coordenação motora, o trabalho em equipe e hábitos saudáveis.', icon: 'heartpulse' }
        ],
        image: tab3
    }
]

const iconMap: Record<string, any> = {
    lightbulb: Lightbulb,
    book: BookOpen,
    target: Target,
    handheart: HandHeart,
    users: Users,
    smile: Smile,
    treepine: TreePine,
    trophy: Trophy,
    heartpulse: HeartPulse
}

const tabIcons = [Brain, Heart, Dumbbell]
---

<section class="w-full py-16 lg:py-24 bg-gray-50 methodology-section">
    <div class="container mx-auto px-4">
        <div class="flex justify-center gap-2 md:gap-3 mb-12" role="tablist">
            {tabs.map((tab, index) => {
                const TabIcon = tabIcons[index]
                return (
                    <button
                        type="button"
                        role="tab"
                        aria-selected={index === 0 ? 'true' : 'false'}
                        aria-controls={`panel-${index}`}
                        id={`tab-${index}`}
                        data-index={index}
                        class={`tab-btn flex items-center gap-2 px-4 md:px-6 py-3 text-xs md:text-sm font-bold uppercase tracking-wider transition-all rounded-lg ${
                            index === 0 ? 'text-white bg-[#009640]' : 'text-gray-600 bg-white hover:bg-gray-100 border-2 border-gray-200'
                        }`}
                    >
                        <TabIcon width="18" height="18" />
                        <span class="hidden sm:inline">{tab.label}</span>
                    </button>
                )
            })}
        </div>

        <div class="max-w-7xl mx-auto">
            {tabs.map((tab, index) => (
                <div
                    id={`panel-${index}`}
                    role="tabpanel"
                    aria-labelledby={`tab-${index}`}
                    class={`tab-panel ${index === 0 ? '' : 'hidden'}`}
                >
                    <div class="bg-[#009640] rounded-2xl shadow-xl overflow-hidden lg:overflow-visible">
                        <div class="grid grid-cols-1 lg:grid-cols-5 items-center">
                            <div class="lg:col-span-2 relative lg:min-h-[400px] order-1 lg:order-2 lg:-mr-8 lg:my-8">
                                <Image
                                    src={tab.image}
                                    alt={tab.title}
                                    class="tab-image w-full h-full object-cover rounded-none lg:rounded-2xl lg:shadow-2xl"
                                />
                            </div>

                            <div class="lg:col-span-3 px-6 pt-4 pb-6 lg:p-12 text-white order-2 lg:order-1">
                                <h3 class="text-2xl lg:text-4xl font-bold mb-6 leading-tight">
                                    {tab.title}
                                </h3>
                                <div class="space-y-4">
                                    {tab.content.map((item) => {
                                        const ItemIcon = iconMap[item.icon]
                                        return (
                                            <div class="flex gap-4 p-4 bg-white/10 backdrop-blur-sm rounded-xl">
                                                <div class="shrink-0 w-10 h-10 bg-[#FFD000] rounded-lg flex items-center justify-center">
                                                    <ItemIcon width="20" height="20" class="text-[#004e21]" />
                                                </div>
                                                <p class="text-white/90 text-sm lg:text-base leading-relaxed">
                                                    {item.text}
                                                </p>
                                            </div>
                                        )
                                    })}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            ))}
        </div>
    </div>
</section>

<script>
    const section = document.querySelector('.methodology-section')
    if (section) {
        const btns = section.querySelectorAll('.tab-btn')
        const panels = section.querySelectorAll('.tab-panel')

        btns.forEach(btn => {
            btn.addEventListener('click', () => {
                const index = parseInt(btn.getAttribute('data-index') || '0')

                btns.forEach(b => {
                    b.setAttribute('aria-selected', 'false')
                    b.classList.remove('text-white', 'bg-[#009640]')
                    b.classList.add('text-gray-600', 'bg-white', 'hover:bg-gray-100', 'border-2', 'border-gray-200')
                })

                btn.setAttribute('aria-selected', 'true')
                btn.classList.add('text-white', 'bg-[#009640]')
                btn.classList.remove('text-gray-600', 'bg-white', 'hover:bg-gray-100', 'border-2', 'border-gray-200')

                panels.forEach((p, i) => {
                    if (i === index) {
                        p.classList.remove('hidden')
                    } else {
                        p.classList.add('hidden')
                    }
                })
            })
        })
    }
</script>


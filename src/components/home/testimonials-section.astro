---
import { Image } from 'astro:assets'
import quoteIcon from '@/assets/images/quote.svg'
import ChevronLeft from '~icons/lucide/chevron-left'
import ChevronRight from '~icons/lucide/chevron-right'

const testimonials = [
    {
        id: 1,
        text: 'Eu estava em busca de algo que fosse o complemento da minha casa, um colégio que abraçasse como se fosse família e oferecesse conteúdo, e tudo que eu buscava encontrei aqui.',
        author: 'Carolina Juvenal Simões',
        role: 'Mãe de aluno o Ensino Médio',
    },
    {
        id: 2,
        text: 'Eu sempre senti da parte do Colégio esse amparo familiar. Aqui eles sabem o nome delas, elas tem identidade no Colégio.',
        author: 'Tatiana Gonçalves Nunes',
        role: 'Mãe de alunas do Ensino Fundamental e Médio',
    },
    {
        id: 3,
        text: 'Eu gosto muito da proximidade dos alunos com os professores. Eles se sentem livres para falar e esclarecer as dúvidas, o que contrubui muito para a confiança neles mesmos.',
        author: 'Romína Magdalena Garcia Lizana',
        role: 'Mãe de alunos do Ensino Fundamental e Médio',
    },
    {
        id: 4,
        text: 'Aqui, a gente vê o cuidado com as diferenças, não só a intelectualidade. A escola valoriza o lado humano, isso para mim não tem preço e é por isso que eu gosto de trabalhar aqui.',
        author: 'José Antonio Neto',
        role: 'Professor de Biologia do Ensino Médio',
    },
    {
        id: 5,
        text: 'É uma escolha acolhedora, que abraça as causas, que tenta ouvir os alunos, os pais e os professores. Nós damos valor ao ser humano, ele não é apenas um número aqui.',
        author: 'Bethânia Menezes de Paiva',
        role: 'Professora Polivalente do Ensino Fundamental',
    },
    {
        id: 6,
        text: 'Essa foi a primeira escola que eu realmente gostei, foi onde eu me adaptei muito bem e que no primeiro dia eu já quis ficar.',
        author: 'Melissa Gonçalves Nunes',
        role: 'Aluna do Ensino Médio',
    },
    {
        id: 7,
        text: 'Todo mundo trabalha junto, você sempre terá alguém ali. Se você precisar de alguma coisa, você pode contar com a escola.',
        author: 'Beatriz Albuquerque Hartmann Penna',
        role: 'Aluna do Ensino Fundamental',
    },
    {
        id: 8,
        text: 'Eu costumo dizer que a melhor escola é aquela em que o nosso filho se sente bem e pra gente eles se sentem bem aqui.',
        author: 'Priscila de Paiva Santos Pereira',
        role: 'Mãe de alunos do Ensino Fundamental e Médio',
    },
    {
        id: 9,
        text: 'A escola está sempre de portas abertas para nós. Existe essa interação com os pais e famílias.',
        author: 'Márcio Ricardo Jaime Pereira',
        role: 'Pai de Alunos do Ensino Fundamental e Médio',
    },
]
---

<section class="relative w-full py-16 testimonials-section" id="depoimentos">
    <div class="w-full flex items-center lg:justify-end mb-8">
        <h2 class="w-full lg:w-1/2 lg:pl-36 text-4xl lg:text-5xl xl:text-6xl font-extrabold text-[#00692d] leading-tight flex items-center lg:items-start justift-start flex-col">
            <span>Quem ama</span>
            <span>Quem cuida</span>
            <span>Quem Participa</span>
            <span>Quem confia</span>
        </h2>
    </div>
    <div class="relative container mx-auto px-4">
        <div class="slider-container relative min-h-[300px]">
            {testimonials.map((t, index) => (
                <blockquote 
                    class={`testimonial-slide bg-white text-center flex items-center justify-center flex-col gap-4 lg:gap-6 rounded-xl p-8 lg:p-12 shadow-xl absolute top-0 left-0 w-full transition-opacity duration-500 ${index === 0 ? 'opacity-100 z-10 relative' : 'opacity-0 z-0 pointer-events-none'}`}
                    data-index={index}
                >
                    <div class="absolute -bottom-4 lg:bottom-8 right-8 w-12 lg:w-16 h-12 lg:h-16 z-20 rotate-180">
                        <Image src={quoteIcon} alt="Citação" class="w-full h-full object-contain" />
                    </div>
                    <p class="text-lg lg:text-xl text-[#00692d] max-w-[780px] font-medium leading-relaxed">
                        {t.text}
                    </p>
                    <div>
                        <h3 class="font-bold text-slate-800 text-lg">
                            {t.author}
                        </h3>
                        <p class="text-sm text-gray-500 uppercase tracking-wide">
                            {t.role}
                        </p>
                    </div>
                </blockquote>
            ))}
        </div>

        <div class="flex items-center justify-center gap-4 mt-8">
            <button
                id="prev-btn"
                class="p-2 rounded-full border-2 border-[#00692d] text-[#00692d] hover:bg-[#00692d] hover:text-white transition-colors"
                aria-label="Anterior"
            >
                <ChevronLeft width="24" height="24" />
            </button>
            <button
                id="next-btn"
                class="p-2 rounded-full border-2 border-[#00692d] text-[#00692d] hover:bg-[#00692d] hover:text-white transition-colors"
                aria-label="Próximo"
            >
                <ChevronRight width="24" height="24" />
            </button>
        </div>
    </div>
    <div class="absolute top-0 left-0 h-full w-1/2 -z-10 bg-yellow-100 opacity-50"></div>
</section>

<script>
    const section = document.querySelector('.testimonials-section')
    if (section) {
        const slides = section.querySelectorAll('.testimonial-slide')
        const prevBtn = section.querySelector('#prev-btn')
        const nextBtn = section.querySelector('#next-btn')
        let currentIndex = 0
        const total = slides.length

        function showSlide(index: number) {
            slides.forEach((slide, i) => {
                if (i === index) {
                    slide.classList.remove('opacity-0', 'z-0', 'pointer-events-none', 'absolute')
                    slide.classList.add('opacity-100', 'z-10', 'relative')
                } else {
                    slide.classList.remove('opacity-100', 'z-10', 'relative')
                    slide.classList.add('opacity-0', 'z-0', 'pointer-events-none', 'absolute')
                }
            })
            currentIndex = index
        }

        nextBtn?.addEventListener('click', () => {
            showSlide((currentIndex + 1) % total)
        })

        prevBtn?.addEventListener('click', () => {
            showSlide((currentIndex - 1 + total) % total)
        })
    }
</script>
